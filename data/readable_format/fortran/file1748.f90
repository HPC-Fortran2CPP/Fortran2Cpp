PROGRAM TestDLCTES
  IMPLICIT NONE
  DOUBLE PRECISION :: ZR, ZI, D
  LOGICAL :: RESULT
  LOGICAL, EXTERNAL :: DLCTES

  ZR = -1.0D0
  ZI = 0.0D0
  D = 0.0D0
  RESULT = DLCTES(ZR, ZI, D)
  PRINT *, 'Test 1: ', RESULT

  ZR = 1.0D0
  D = -1.0D0
  RESULT = DLCTES(ZR, ZI, D)
  PRINT *, 'Test 2: ', RESULT

  ZR = -1.0D0
  D = 1.0D0
  RESULT = DLCTES(ZR, ZI, D)
  PRINT *, 'Test 3: ', RESULT

END PROGRAM TestDLCTES

LOGICAL FUNCTION DLCTES(ZR, ZI, D)
  DOUBLE PRECISION, INTENT(IN) :: ZR, ZI, D
  DOUBLE PRECISION :: ZERO, ONE
  PARAMETER (ZERO = 0.0D0, ONE = 1.0D0)

  IF (D .EQ. ZERO) THEN
    DLCTES = (ZR .LT. ZERO)
  ELSE
    DLCTES = (SIGN(ONE, ZR) .NE. SIGN(ONE, D))
  END IF
END FUNCTION DLCTES