MODULE COMPUTE_COUPLING_FLUID_CMB__genmod
  IMPLICIT NONE
CONTAINS
  SUBROUTINE COMPUTE_COUPLING_FLUID_CMB(DISPL_CRUST_MANTLE, NGLOB_CM)
    INTEGER, INTENT(IN) :: NGLOB_CM
    REAL, DIMENSION(3, NGLOB_CM), INTENT(INOUT) :: DISPL_CRUST_MANTLE
    INTEGER :: i, j
    DO i = 1, NGLOB_CM
       DO j = 1, 3
          DISPL_CRUST_MANTLE(j, i) = DISPL_CRUST_MANTLE(j, i) + 1.0
       END DO
    END DO
  END SUBROUTINE COMPUTE_COUPLING_FLUID_CMB
END MODULE COMPUTE_COUPLING_FLUID_CMB__genmod

PROGRAM testComputeCouplingFluidCmb
  USE COMPUTE_COUPLING_FLUID_CMB__genmod
  IMPLICIT NONE
  INTEGER, PARAMETER :: NGLOB_CM = 3
  REAL, DIMENSION(3, NGLOB_CM) :: DISPL_CRUST_MANTLE
  INTEGER :: i, j

  ! Initialize DISPL_CRUST_MANTLE with some test values
  DO i = 1, NGLOB_CM
     DO j = 1, 3
        DISPL_CRUST_MANTLE(j, i) = REAL(i + j)
     END DO
  END DO

  PRINT *, "Before calling COMPUTE_COUPLING_FLUID_CMB:"
  PRINT *, DISPL_CRUST_MANTLE

  ! Call the subroutine
  CALL COMPUTE_COUPLING_FLUID_CMB(DISPL_CRUST_MANTLE, NGLOB_CM)

  PRINT *, "After calling COMPUTE_COUPLING_FLUID_CMB:"
  PRINT *, DISPL_CRUST_MANTLE
END PROGRAM testComputeCouplingFluidCmb