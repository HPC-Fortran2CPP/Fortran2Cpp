MODULE XYZ_2_LATLON_MINMAX__genmod
  INTERFACE 
    SUBROUTINE XYZ_2_LATLON_MINMAX(NSPEC,NGLOB,IBOOL,XSTORE,    &
 &YSTORE,ZSTORE,LAT_MIN,LAT_MAX,LON_MIN,LON_MAX)
      INTEGER(KIND=4), INTENT(IN) :: NGLOB
      INTEGER(KIND=4), INTENT(IN) :: NSPEC
      INTEGER(KIND=4), INTENT(IN) :: IBOOL(5,5,5,NSPEC)
      REAL(KIND=4), INTENT(IN) :: XSTORE(NGLOB)
      REAL(KIND=4), INTENT(IN) :: YSTORE(NGLOB)
      REAL(KIND=4), INTENT(IN) :: ZSTORE(NGLOB)
      REAL(KIND=8), INTENT(OUT) :: LAT_MIN
      REAL(KIND=8), INTENT(OUT) :: LAT_MAX
      REAL(KIND=8), INTENT(OUT) :: LON_MIN
      REAL(KIND=8), INTENT(OUT) :: LON_MAX
    END SUBROUTINE XYZ_2_LATLON_MINMAX
  END INTERFACE 
END MODULE XYZ_2_LATLON_MINMAX__genmod

PROGRAM test_xyz_2_latlon_minmax
  USE XYZ_2_LATLON_MINMAX__genmod
  IMPLICIT NONE
  
  INTEGER, PARAMETER :: NSPEC = 1, NGLOB = 3
  INTEGER :: IBOOL(5,5,5,NSPEC) = 0
  REAL(KIND=4) :: XSTORE(NGLOB) = [0.0, 1.0, 0.5]
  REAL(KIND=4) :: YSTORE(NGLOB) = [0.0, 0.0, 1.0]
  REAL(KIND=4) :: ZSTORE(NGLOB) = [1.0, 1.0, 1.0]
  REAL(KIND=8) :: LAT_MIN, LAT_MAX, LON_MIN, LON_MAX

  CALL XYZ_2_LATLON_MINMAX(NSPEC, NGLOB, IBOOL, XSTORE, YSTORE, ZSTORE, LAT_MIN, LAT_MAX, LON_MIN, LON_MAX)
  
  PRINT *, "LAT_MIN: ", LAT_MIN
  PRINT *, "LAT_MAX: ", LAT_MAX
  PRINT *, "LON_MIN: ", LON_MIN
  PRINT *, "LON_MAX: ", LON_MAX
END PROGRAM test_xyz_2_latlon_minmax

! Implementation of the subroutine
SUBROUTINE XYZ_2_LATLON_MINMAX(NSPEC,NGLOB,IBOOL,XSTORE,YSTORE,ZSTORE,LAT_MIN,LAT_MAX,LON_MIN,LON_MAX)
  INTEGER(KIND=4), INTENT(IN) :: NGLOB
  INTEGER(KIND=4), INTENT(IN) :: NSPEC
  INTEGER(KIND=4), INTENT(IN) :: IBOOL(5,5,5,NSPEC)
  REAL(KIND=4), INTENT(IN) :: XSTORE(NGLOB)
  REAL(KIND=4), INTENT(IN) :: YSTORE(NGLOB)
  REAL(KIND=4), INTENT(IN) :: ZSTORE(NGLOB)
  REAL(KIND=8), INTENT(OUT) :: LAT_MIN
  REAL(KIND=8), INTENT(OUT) :: LAT_MAX
  REAL(KIND=8), INTENT(OUT) :: LON_MIN
  REAL(KIND=8), INTENT(OUT) :: LON_MAX

  ! Add the actual conversion logic here. For now, just setting them to some dummy values.
  LAT_MIN = 0.0
  LAT_MAX = 90.0
  LON_MIN = -180.0
  LON_MAX = 180.0
END SUBROUTINE XYZ_2_LATLON_MINMAX