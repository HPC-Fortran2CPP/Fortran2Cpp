MODULE CHR_ACHR_MOD
  IMPLICIT NONE
CONTAINS
  CHARACTER(len=1) FUNCTION CHR_ACHR(ASCII)
    INTEGER, INTENT(IN) :: ASCII
    INTEGER, PARAMETER :: DEL = 127
    INTEGER, PARAMETER :: NUL = 0
    IF (ASCII > NUL .AND. ASCII <= DEL) THEN
      CHR_ACHR = CHAR(ASCII)
    ELSE
      CHR_ACHR = CHAR(NUL)
    END IF
  END FUNCTION CHR_ACHR
END MODULE CHR_ACHR_MOD

PROGRAM TestCHR_ACHR
  USE CHR_ACHR_MOD
  IMPLICIT NONE
  CHARACTER(len=1) :: result
  INTEGER :: test_vals(5) = (/0, 65, 127, 128, -1/)
  INTEGER :: i

  DO i = 1, 5
    result = CHR_ACHR(test_vals(i))
    PRINT *, 'ASCII code', test_vals(i), 'yields character', ACHAR(ICHAR(result))
  END DO
END PROGRAM TestCHR_ACHR