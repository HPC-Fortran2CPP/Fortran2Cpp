PROGRAM TEST_WTPROJ
  IMPLICIT NONE
  DOUBLE PRECISION DLAT, DLON, UVAL, VVAL, CSLT
  
  ! Test values
  DLAT = 0.5
  DLON = 0.5
  CSLT = 1.0
  
  ! Call the subroutine
  CALL WTPROJ(DLAT, DLON, UVAL, VVAL, CSLT)
  
  ! Print results
  PRINT *, "UVAL: ", UVAL, "VVAL: ", VVAL

CONTAINS

  SUBROUTINE WTPROJ(DLAT, DLON, UVAL, VVAL, CSLT)
    DOUBLE PRECISION DLAT, DLON, UVAL, VVAL, CSLT
    DOUBLE PRECISION TVAL
    ! Calculation
    TVAL = ACOS(COS(DLAT) * COS(0.5D0 * DLON))
    IF (ABS(TVAL) > 1.D-6) THEN
      TVAL = SIN(TVAL) / TVAL
    ELSE
      TVAL = 1.D0
    END IF
    UVAL = 2.D0 * COS(DLAT) * SIN(0.5D0 * DLON) / TVAL
    VVAL = SIN(DLAT) / TVAL
    UVAL = 0.5D0 * (DLON * CSLT + UVAL)
    VVAL = 0.5D0 * (DLAT + VVAL)
    RETURN
  END SUBROUTINE WTPROJ

END PROGRAM TEST_WTPROJ