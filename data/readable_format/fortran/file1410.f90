MODULE GRVT__genmod
  IMPLICIT NONE
  CONTAINS

  SUBROUTINE GRVT(ISHP, NDS, R, GWT, GCONST, GRAVDIR, DENSITY, FINTE)
    INTEGER, INTENT(IN) :: NDS, ISHP
    REAL(KIND=8), INTENT(IN) :: R(ISHP)
    REAL(KIND=8), INTENT(IN) :: GWT, GCONST, DENSITY
    INTEGER, INTENT(IN) :: GRAVDIR
    REAL(KIND=8), INTENT(INOUT) :: FINTE(ISHP*NDS, 1)

    INTEGER :: i, j
    ! Example calculation
    DO i = 1, ISHP
      DO j = 1, NDS
        FINTE((i-1)*NDS+j, 1) = GWT * GCONST * DENSITY * R(i) * GRAVDIR
      END DO
    END DO
  END SUBROUTINE GRVT

END MODULE GRVT__genmod

PROGRAM test_grvt
  USE GRVT__genmod
  IMPLICIT NONE

  INTEGER, PARAMETER :: ISHP=2, NDS=3
  REAL(KIND=8) :: R(ISHP) = [1.5d0, 2.0d0]
  REAL(KIND=8) :: GWT = 9.81d0
  REAL(KIND=8) :: GCONST = 6.67430d-11
  INTEGER :: GRAVDIR = 1
  REAL(KIND=8) :: DENSITY = 1000.0d0
  REAL(KIND=8) :: FINTE(ISHP*NDS, 1)
  INTEGER :: i

  CALL GRVT(ISHP, NDS, R, GWT, GCONST, GRAVDIR, DENSITY, FINTE)

  PRINT *, "Fortran Stdout:"
  DO i = 1, ISHP*NDS
    PRINT *, "FINTE(", i, ",1) = ", FINTE(i, 1)
  END DO
END PROGRAM test_grvt