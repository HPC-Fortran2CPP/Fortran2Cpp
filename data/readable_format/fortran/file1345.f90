MODULE BUFRQEL_mod
  INTERFACE
    SUBROUTINE BUFRQEL(STRING,CMPRES,LASTEL,LASBIT,N,NEXBIT,    &
     SCALE,WIDTH,REFVAL,FORMAT,DESCR,NLOG,IRC)
      IMPLICIT NONE
      CHARACTER(LEN=*), INTENT(IN)     :: STRING
      LOGICAL,          INTENT(IN)     :: CMPRES
      INTEGER,          INTENT(IN)     :: LASTEL
      INTEGER,          INTENT(IN)     :: LASBIT
      INTEGER,          INTENT(IN)     :: N
      INTEGER,          INTENT(INOUT)  :: NEXBIT
      INTEGER,          INTENT(INOUT)  :: SCALE
      INTEGER,          INTENT(INOUT)  :: WIDTH
      INTEGER,          INTENT(INOUT)  :: REFVAL
      CHARACTER(LEN=1), INTENT(INOUT)  :: FORMAT
      INTEGER,          INTENT(INOUT)  :: DESCR(*)
      INTEGER,          INTENT(INOUT)  :: NLOG
      INTEGER,          INTENT(OUT)    :: IRC
    END SUBROUTINE BUFRQEL
  END INTERFACE
END MODULE BUFRQEL_mod

SUBROUTINE BUFRQEL(STRING,CMPRES,LASTEL,LASBIT,N,NEXBIT,    &
 SCALE,WIDTH,REFVAL,FORMAT,DESCR,NLOG,IRC)
  IMPLICIT NONE
  CHARACTER(LEN=*), INTENT(IN)     :: STRING
  LOGICAL,          INTENT(IN)     :: CMPRES
  INTEGER,          INTENT(IN)     :: LASTEL
  INTEGER,          INTENT(IN)     :: LASBIT
  INTEGER,          INTENT(IN)     :: N
  INTEGER,          INTENT(INOUT)  :: NEXBIT
  INTEGER,          INTENT(INOUT)  :: SCALE
  INTEGER,          INTENT(INOUT)  :: WIDTH
  INTEGER,          INTENT(INOUT)  :: REFVAL
  CHARACTER(LEN=1), INTENT(INOUT)  :: FORMAT
  INTEGER,          INTENT(INOUT)  :: DESCR(*)
  INTEGER,          INTENT(INOUT)  :: NLOG
  INTEGER,          INTENT(OUT)    :: IRC
  
  ! Example implementation (simply setting IRC to a success value)
  IRC = 0
  PRINT *, 'BUFRQEL called successfully.'
END SUBROUTINE BUFRQEL

PROGRAM test_BUFRQEL
  USE BUFRQEL_mod
  IMPLICIT NONE
  
  CHARACTER(LEN=10) :: STRING = 'Test'
  LOGICAL :: CMPRES = .TRUE.
  INTEGER :: LASTEL = 10
  INTEGER :: LASBIT = 5
  INTEGER :: N = 1
  INTEGER :: NEXBIT = 0
  INTEGER :: SCALE = 0
  INTEGER :: WIDTH = 0
  INTEGER :: REFVAL = 0
  CHARACTER(LEN=1) :: FORMAT = 'I'
  INTEGER, ALLOCATABLE :: DESCR(:)
  INTEGER :: NLOG = 0
  INTEGER :: IRC
  
  ALLOCATE(DESCR(N))
  DESCR(1) = 1234
  
  CALL BUFRQEL(STRING, CMPRES, LASTEL, LASBIT, N, NEXBIT, SCALE, WIDTH, REFVAL, FORMAT, DESCR, NLOG, IRC)
  
  PRINT *, 'Test completed.'
END PROGRAM test_BUFRQEL